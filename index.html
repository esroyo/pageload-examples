<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Pageload examples</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Learn how a web page loads by example">
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">
  <link rel="stylesheet" href="./assets/new.css">
  <link rel="preload" as="style" href="./assets/inter.css" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="./assets/inter.css"></noscript>
	<script defer src="./assets/microlight.js"></script>
</head>
<body>
  <header>
    <h1>ğŸŒ&nbsp; Page loading</h1>
  </header>

  <details id="toc" open>
    <summary>Table of contents</summary>
    <ul>
      <li><a href="#basic-html">Loading a web site is a gradual process</a></li>
      <li><a href="#basic-html-style">External styles block rendering, but not document parsing</a></li>
      <li><a href="#basic-html-style-inline">Fast styled rendering, with inline styles</a></li>
      <li><a href="#basic-html-style-critical">Sweet spot: inline critical styles</a></li>
      <li><a href="#basic-html-script">Scripts block document parsing, but not rendering</a></li>
      <li><a href="#basic-html-style-script">Scripts execution requires to finish any ongoing styles loading</a></li>
      <li><a href="#basic-html-style-script-defer">Deferred scripts don't block document parsing</a></li>
      <li><a href="#basic-html-style-script-async">Async scripts block (almost) nothing</a></li>
      <li><a href="#basic-html-script-dynamic">Dynamic scripts behave like async by default</a></li>
    </ul>
  </details>  

  <hr>

  <article id="basic-html">
    <h2>ğŸ“ Loading a web site is a gradual process</h2>

    <figure>
      <blockquote>
        It's important to understand that [...] is a gradual process. For better user experience, the rendering engine will try to display contents on the screen as soon as possible. It will not wait until all HTML is parsed before starting to build and layout the render tree. Parts of the content will be parsed and displayed, while the process continues with the rest of the contents that keeps coming from the network.
      </blockquote>
      <figcaption>
        &mdash; Tali Garsiel, <cite>How browsers work</cite>
      </figcaption>
    </figure>

    <p>Let's demonstrate that fact by loading a page with lots of text content. Page download is throttled by the server and takes a long time.</p>
    <p>Try to scroll down while the page is being downloaded.</p>
    <p>The display keeps updating, but <code>DOMContentLoaded</code> event won't trigger until the download and parsing of the HTML is <em>completed</em>.</p>
    <p>There is no <em>direct</em> correlation between the delay on those events and a poor core web vitals score. Although the page is loading, LCP will happen soon enough. This doesn't mean the "performance" of the page is good.</p>

    <p>
    <a href="https://proxy-throttle.deno.dev/?factor=5&url=https%3A%2F%2Fesroyo.github.io%2Fpageload-examples%2Fexamples%2Fbasic-html%2F" target="_blank"><button>Open example</button></a>
    </p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;html throttle="5"&gt;
  &lt;head&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;!-- Long HTML contents --&gt;

  &lt;/body&gt;
&lt;/html&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      18.10 <span style="opacity:.5">â”œ</span> requestStart
     171.60 <span style="opacity:.5">â”œ</span> responseStart
            <span style="opacity:.5">â”Š</span>
    2925.30 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
    2925.30 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   30235.70 <span style="opacity:.5">â”œ</span> responseEnd
   30236.70 <span style="opacity:.5">â”œ</span> domInteractive
   30236.80 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
   30236.80 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
   30237.10 <span style="opacity:.5">â”œ</span> domComplete
   30237.20 <span style="opacity:.5">â”œ</span> loadEventStart
   30237.20 <span style="opacity:.5">â””</span> loadEventEnd</pre>
       <figcaption>
          Timeline: It shows the first paint happening much earlier than the HTML's response end.
        </figcaption>
      </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style">
    <h2>ğŸ“ External styles block rendering, but not document parsing</h2>
    <p>As we have seen in the previous example, the DOM content tree is gradually builded as the HTML is downloaded. What if we have an stylesheet link on that page?</p>

    <p>An external stylesheet by itself does not block <em>all</em> of the process. The fetching of the stylesheet starts, but the HTML parsing continues. The <code>DOMContentLoaded</code> event will trigger regardless the style state.</p>

    <p><em>However</em>, although the <code>DOMContentLoaded</code> event fires, <strong>the page won't be displayed to the user</strong> until the fetching of the style is done.</p>

    <p>This means an stylesheet resource doesn't block the document parsing, but will block the rendering. From JavaScript land It feels strange to have no visual feedback when <code>DOMContentLoaded</code> has already fired. There seems to be no way to force the browser into the first paint.</p>

    <p>If an style is added dynamically from JavaScript, It won't block the rendering. Even if that is done <em>before</em> the first render.</p>

    <p>While there are pending styles to download and parse, the window `load` will not fire. No matter how late they have been added to the DOM.</p>

    <p>Syles imported with <code>@import</code> statements from the external styles are considered part of the same loading process.</p>

    <p>
    <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style/" target="_blank"><button>Open example</button></a>
    </p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;link rel="stylesheet" href="./assets/new.css" throttle="10"&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;!-- Long HTML contents --&gt;

&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      27.90 <span style="opacity:.5">â”œ</span> requestStart
     174.90 <span style="opacity:.5">â”œ</span> responseStart
     177.90 <span style="opacity:.5">â”œ</span> responseEnd
     184.30 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
     194.10 <span style="opacity:.5">â”œ</span> domInteractive
     194.10 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
     194.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   10472.40 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
   10525.70 <span style="opacity:.5">â”œ</span> domComplete
   10525.80 <span style="opacity:.5">â”œ</span> loadEventStart
   10525.90 <span style="opacity:.5">â”œ</span> loadEventEnd
   10600.20 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
   10600.20 <span style="opacity:.5">â””</span> paint: <span style="opacity:.6">first-contentful-paint</span></pre>
      <figcaption>
          Timeline: It shows that an external style link does not block the document parsing nor the <code>DOMContentLoaded</code> event. However the first paint won't happen until the download and processing of the style resource ends. 
        </figcaption>
    </figure>

    </details>

    <details>
      <summary>Quirks</summary>
      <ul>
        <li><mark>Blink</mark>; When the <code>link</code> tag is located in the <code>head</code>, then as claimed the document parsing is not blocked. However if the <code>link</code> tag is located in the <code>body</code>, <strong>It blocks the document parsing</strong> (the hard way). Test it in <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style-body/" target="_blank">this secondary example</a>. Gecko and WebKit based browsers don't observe this difference between <code>body</code> and <code>head</code>.</li>
      </ul>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style-inline">
    <h2>ğŸ“ Fast styled rendering, with inline styles</h2>

    <p>We can achieve the gradual rendering effect seen on the <a href="#basic-html">first example</a> while displaying already styled content. It is possible by inlining the contents of the stylesheet.</p>

    <p>Although inlining styles is a limited option (prevents caching, is difficult to scale),
    for the shake of the example It is cool to see how the browser can build the DOM and render styled contents as the HTML is dowloaded.</p>

    <p>
    <a href="https://proxy-throttle.deno.dev/?factor=5&url=https%3A%2F%2Fesroyo.github.io%2Fpageload-examples%2Fexamples%2Fbasic-html-style-inline%2F" target="_blank"><button>Open example</button></a>
    </p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;style&gt;
    /* Inlined CSS */
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;!-- Long HTML contents --&gt;

&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      19.60 <span style="opacity:.5">â”œ</span> requestStart
     539.10 <span style="opacity:.5">â”œ</span> responseStart
            <span style="opacity:.5">â”Š</span>
    3240.20 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
    3240.20 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   35312.40 <span style="opacity:.5">â”œ</span> responseEnd
   35313.20 <span style="opacity:.5">â”œ</span> domInteractive
   35313.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
   35313.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
   35313.40 <span style="opacity:.5">â”œ</span> domComplete
   35313.40 <span style="opacity:.5">â”œ</span> loadEventStart
   35313.40 <span style="opacity:.5">â””</span> loadEventEnd</pre>
        <figcaption>
          Timeline: It shows an early painting, given there are no external resources.
        </figcaption>
      </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style-critical">
    <h2>ğŸ“ Sweet spot: inline critical styles</h2>

    <p>The best experience comes when only <a href="https://css-tricks.com/authoring-critical-fold-css/" target="_blank">critical styles</a> are inlined, as we get the gradual rendering effect of styled content.</p>

    <p>However It forces the loading of the non-critical styles on a deferred stage. The <code>media</code> attribute <a href="https://github.com/filamentgroup/loadCSS" target="_blank">trick</a> is a well known option for the deferred load. Although It feels hackish and relies on JavaScript.</p>

    <p>Another possiblity would be to put the non-critical styles in a <code>link rel="preload"</code> tag. That <code>link</code> wouldn't block document parsing nor rendering. Finally place the regular <code>link</code> to the same style at the very end of the <code>body</code>. Rendering can't be blocked if something has been already painted.</p>

    <p>This would be a sweet spot solution, except for the quirk commented on the <a href="#basic-html-style">external styles example</a>. Blink blocks the document parsing when it finds a style <code>link</code> in the <code>body</code>. Thus although the visual exeperience is good, the delay of <code>DOMContentLoaded</code> makes this solution non-generalizable.</p>

    <p><a href="https://proxy-throttle.deno.dev/?factor=2&url=https%3A%2F%2Fesroyo.github.io%2Fpageload-examples%2Fexamples%2Fbasic-html-style-critical-blink%2F" target="_blank">This secondary example</a> shows the alternative for Blink (using the <code>onload</code> attribute).</p>

    <p>On a more general note, be aware of abusing preloading. On HTTP/1.1 you can easily hit the number of concurrent connections to the same domain (6 in Chrome). Aside from that, remember that you are hand-picking high priority resources. That implicitly de-prioritizes other resources.</p>

    <p>
    <a href="https://proxy-throttle.deno.dev/?factor=2&url=https%3A%2F%2Fesroyo.github.io%2Fpageload-examples%2Fexamples%2Fbasic-html-style-critical%2F" target="_blank"><button>Open example</button></a>
    </p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;link rel="preload" as="style" href="./assets/new.css" throttle="15"&gt;
  &lt;style&gt;
    /* Limited critical CSS */
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;!-- Long HTML contents --&gt;

  &lt;link rel="stylesheet" href="./assets/new.css" throttle="15"&gt;
&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      83.00 <span style="opacity:.5">â”œ</span> requestStart
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    8135.00 <span style="opacity:.5">â”œ</span> responseStart
    8199.00 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
    8224.00 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   17041.00 <span style="opacity:.5">â”œ</span> responseEnd
   17056.00 <span style="opacity:.5">â”œ</span> domInteractive
   17056.00 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
   17056.00 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   23495.00 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
   23667.00 <span style="opacity:.5">â”œ</span> domComplete
   23667.00 <span style="opacity:.5">â”œ</span> loadEventStart
   23667.00 <span style="opacity:.5">â””</span> loadEventEnd</pre>
        <figcaption>
          Timeline: It shows an early paint. Contents are displayed as they arrive, styled with the critical inlined styles. Meanwhile non-critical styles are being preloaded and won't block anything. Once the non-critical styles are downloaded the styles are applied (reflow). This sequence of events is taken from a WebKit based browser.
        </figcaption>
    </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-script">
    <h2>ğŸ“ Scripts block document parsing, but not rendering</h2>
    <p>When an script is found in the HTML, the browser pauses the document parsing until the script is executed.</p>

    <p>If the script is external, It must be fetched and then executed. Document parsing won't continue until the script ends execution.</p>

    <p>Givent that an script does not necessarily block the rendering, the location of the script in the document is important. If the script is located at the end of the body, some rendering is possible</p>.

    <p>
    <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-script/" target="_blank"><button>Open example</button></a>
    </p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;!-- Long HTML contents --&gt;

  &lt;script src="./assets/junk.js" throttle="10"&gt;&lt;/script&gt;
&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      25.20 <span style="opacity:.5">â”œ</span> requestStart
     174.00 <span style="opacity:.5">â”œ</span> responseStart
     177.90 <span style="opacity:.5">â”œ</span> responseEnd
     184.80 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦mples/assets/junk.js")</span>
     247.70 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
     247.70 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   10471.40 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦mples/assets/junk.js")</span>
   10473.40 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution</span>
   10478.60 <span style="opacity:.5">â”œ</span> domInteractive
   10478.70 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
   10478.70 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
   10641.20 <span style="opacity:.5">â”œ</span> domComplete
   10641.30 <span style="opacity:.5">â”œ</span> loadEventStart
   10641.30 <span style="opacity:.5">â””</span> loadEventEnd</pre>
        <figcaption>
          Timeline: It shows that an external script blocks document parsing. Interactive state won't be reached until the script is fetched and executed. However if enough document content has been already parsed, paint still happens.
        </figcaption>
    </figure>

    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style-script">
    <h2>ğŸ“ Scripts execution requires to finish the ongoing styles loading</h2>

    <p>As we have seen <a href="#basic-html-style">previously</a>, and external stylesheet will not block the document parsing. However if the external style is followed by an script, things change.</p>
   
    <p>An script not only pauses the document parsing, but also requires to finish the <em>ongoing</em> styles loading. Only then will start its execution.</p>

    <p>So document parsing becomes blocked when it gets to an script. In turn the script execution is blocked by the loading styles.</p>

    <p>Note we emphasize the fact that only <em>ongoing</em> loading styles will block the script. If the order is inverted and the script is placed before the style, It will get executed immediately. See that in <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-script-style/" target="_blank">this secondary example</a> (timeline will be similar to the <a href="#basic-html-style">second case</a>).</p>

    <p><strong>This rule only applies to <em>initial</em> styles</strong>. That is to stylesheet links that are in the initial HTML response. Stylesheet links added dynamically do not block successive scripts, even if they are added to the document before those scripts.</p>

    <p>When the initial stylesheets contain <code>@import</code> statements, those are considered part of the same style loading. Thus importing styles from styles is a serious concern, as it pospones script execution and rendering. Check that in <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style-style-script/" target="_blank">this other secondary example</a>.</p>

    <p>
    <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style-script/" target="_blank"><button>Open example</button></a>
    </p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;link rel="stylesheet" href="./assets/new.css" throttle="10"&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;!-- Long HTML contents --&gt;

  &lt;script&gt;
    performance.mark('script execution');
  &lt;/script&gt;
&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      20.00 <span style="opacity:.5">â”œ</span> requestStart
     170.80 <span style="opacity:.5">â”œ</span> responseStart
     177.70 <span style="opacity:.5">â”œ</span> responseEnd
     184.30 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   10398.10 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
   10523.80 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution</span>
   10581.60 <span style="opacity:.5">â”œ</span> domInteractive
   10581.60 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
   10581.60 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
   10604.80 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
   10604.80 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
   10721.30 <span style="opacity:.5">â”œ</span> domComplete
   10721.50 <span style="opacity:.5">â”œ</span> loadEventStart
   10721.50 <span style="opacity:.5">â””</span> loadEventEnd</pre>
        <figcaption>
          Timeline: The external style by itself would not block the document parsing, as seen <a href="#basic-html-style">previously</a>. However the script gets blocked by the style loading, and in turn the script blocks the document parsing. Thus DOM interactive is bounded by the style loading plus the script execution.
        </figcaption>
    </figure>

    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style-script-defer">
    <h2>ğŸ“ Deferred scripts don't block document parsing</h2>

    <p>Even though deferred scripts don't block document parsing and get downloaded in parallel (with low priority), they share some key behaviours with the "normal" synchronous script tags:
      <ul>
        <li>They are executed in the order they were added to the DOM tree.</li>
        <li>They are executed before <code>DOMContentLoaded</code> event.</li>
        <li>They don't block rendering. (see <a href="https://esroyo.github.io/pageload-examples/examples/basic-html-script-defer/" target="_blank">secondary example</a>)</li>
        <li>Before execution they must wait for ongoing styles loading (if any) to end.</li>
      </ul>
    </p>

    <p>They are all executed at the same time, before <code>DOMContentLoaded</code>. Therefore all deferred scripts need to be completely downloaded before any of them can execute.</p>

    <p>Roughtly we can think of deferred scripts as synchronous scripts whose execution is pushed towards the end of the document parsing process, with the benefit of prefetching them.</p>

    <p>As a side note, scripts of <code>type=module</code> behave like deferred scripts. They keep order, execute once the document is interative, wait for styles, etc. The most notable difference is that they probably get higher download priority. Also they won't have access to <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/currentScript" target="_blank">document.currentScript</a>.</p>

    <p><a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style-script-defer/" target="_blank"><button>Open example</button></a></p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;link rel="stylesheet" href="./assets/new.css" throttle="10"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;script src="./assets/junk.js?def1" defer throttle="5"&gt;&lt;/script&gt;

  &lt;script src="./assets/junk.js?def2" defer throttle="2"&gt;&lt;/script&gt;

  &lt;!-- Long HTML contents --&gt;

&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      19.90 <span style="opacity:.5">â”œ</span> requestStart
     168.20 <span style="opacity:.5">â”œ</span> responseStart
     174.00 <span style="opacity:.5">â”œ</span> responseEnd
     178.40 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
     178.60 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/assets/junk.js?def1")</span>
     178.90 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/assets/junk.js?def2")</span>
     183.70 <span style="opacity:.5">â”œ</span> domInteractive
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    2385.70 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/assets/junk.js?def2")</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    5457.80 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/assets/junk.js?def1")</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   10372.80 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
   10420.90 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- deferred 1</span>
   10421.20 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- deferred 2</span>
   10421.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
   10421.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
   10500.00 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
   10500.00 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
   10514.20 <span style="opacity:.5">â”œ</span> domComplete
   10514.20 <span style="opacity:.5">â”œ</span> loadEventStart
   10514.20 <span style="opacity:.5">â””</span> loadEventEnd</pre>
       <figcaption>
          Timeline: It shows two deferred scripts that start to download as the document parses. The document parsing ends and It reaches the <em>interactive</em> state. The first deferred script takes 5s to download and the second takes 2s. They need to wait for the style download to end. Then both get executed in order. Finally <code>DOMContentLoaded</code> is fired. The rendering is hold by the style download, not the scripts. Without the external style, rendering would take place almost immediately.
        </figcaption>
    </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style-script-async">
    <h2>ğŸ“ Async scripts block (almost) nothing</h2>

    <p>Async scripts are like "free agents". They:
      <ul>
        <li>Do not block document parsing.</li>
        <li>Do not block rendering.</li>
        <li>Do not require the ongoing styles loading to end.</li>
        <li>Do not require pending scripts to execute.</li>
        <li>Will execute as soon as possible, once they are downloaded.</li>
        <li>Because of that, they may delay ongoing critical processes! (for instance, they could execute while document parsing has not finished).</li>
        <li>Finally, they do block the window <code>load</code> event.</li>
      </ul>
    </p>

    <p><a href="https://proxy-throttle.deno.dev/?factor=0.2&url=https%3A%2F%2Fesroyo.github.io%2Fpageload-examples%2Fexamples%2Fbasic-html-style-script-async%2F" target="_blank"><button>Open example</button></a></p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;link rel="stylesheet" href="./assets/new.css" throttle="1"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;script async src="./assets/junk.js#async1" throttle="5"&gt;&lt;/script&gt;

  &lt;script async src="./assets/fib.js#async2" throttle="0" data-fibonacci-number="42"&gt;&lt;/script&gt;

  &lt;script async src="./assets/junk.js#async3" throttle="1"&gt;&lt;/script&gt;

  &lt;!-- Long HTML contents --&gt;

&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      14.10 <span style="opacity:.5">â”œ</span> requestStart
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
     612.50 <span style="opacity:.5">â”œ</span> responseStart
     623.90 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
     624.80 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦ssets/junk.js?async1")</span>
     625.20 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦assets/fib.js?async2")</span>
     625.40 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦ssets/junk.js?async3")</span>
            <span style="opacity:.5">â”Š</span>
     811.90 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦assets/fib.js?async2")</span>
     814.30 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- async 2</span>
     814.30 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">start fib(42)</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    1399.80 <span style="opacity:.5">â”œ</span> responseEnd
            <span style="opacity:.5">â”Š</span>
    1680.70 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦ssets/junk.js?async3")</span>
    1682.20 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    2955.60 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">end fib(42)</span>
    2959.30 <span style="opacity:.5">â”œ</span> domInteractive
    2959.30 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
    2959.30 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
    2967.30 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- async 3</span>
            <span style="opacity:.5">â”Š</span>
    3139.90 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
    3139.90 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    5835.90 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦ssets/junk.js?async1")</span>
    5837.10 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- async 1</span>
    5837.20 <span style="opacity:.5">â”œ</span> domComplete
    5837.30 <span style="opacity:.5">â”œ</span> loadEventStart
    5837.30 <span style="opacity:.5">â””</span> loadEventEnd</pre>
        <figcaption>
          Timeline: It shows that four external resources start loading (one style, three async scripts) while the document is being received and parsed. The 2nd async script is the first to end its download. At this point none of the other external resources, nor the document itself have been completely received yet. Execution of this 2nd async script starts and takes a while &mdash; around 2seconds, a very looong task! While this script is executing, three other resources have finished arriving (the style, the document itself, and the 3rd async script). They can't be processed while the 2nd script is executing. When the execution of the 2nd script ends, we are unblocked to continue processing stuff. The style is processed. The rest of the document is parsed and reaches the interactive state. And the 3rd async script gets executed. Finally some rendering happens. Much later, the 1st async script ends its download and executes. Only then the <code>load</code> event fires.
        </figcaption>
    </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-script-dynamic">
    <h2>ğŸ“ Dynamic scripts behave like async by default</h2>

    <p>We consider dynamic scripts those that are created &mdash;and added to the DOM&mdash; using JavaScript. This can be done at any time, there is no restriction.</p>

    <p>There are two types of dynamic scripts: async (the default), or sync. There is no straight way to create a dynamic script that acts as <code>defer</code>.</p>

    <p>The insertion of a dynamic script does not block document parsing. Even if they are created in sync mode and are added before the document is <em>interactive</em> state.</p>

    <p>Dynamic sync scripts block each other. They execute in the order they were added to document (the insertion position is irrelevant).</p>

    <p>Dynamic async scripts behave exactly as non-dynamic async scripts: they almost block nothing, and get executed as soon as they are ready.</p>

    <p>In fact any dynamic script may execute in the middle of critical processes like document parsing. It is important to keep your eyes open.</p>

    <p>Finally, they do block the window <code>load</code> event. This is true for <em>every</em> dynamic script (async or sync), disregarding when they are added to the document. If they are added before <code>load</code> has fired, the event will be holded until the pending scripts execute.<p>

    <p><a href="https://proxy-throttle.deno.dev/?factor=0.4&url=https%3A%2F%2Fesroyo.github.io%2Fpageload-examples%2Fexamples%2Fbasic-html-script-dynamic%2F" target="_blank"><button>Open example</button></a></p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;script async src="./assets/junk.js?async1" throttle="0"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;script async src="./assets/junk.js?async2" throttle="9"&gt;&lt;/script&gt;

  &lt;script&gt;
    // mark: script execution -- inline 1
    // Adds a dynamic async script "?dyn-async1" throttle=5
  &lt;/script&gt;

  &lt;script&gt;
    // mark: script execution -- inline 2
    // Adds a dynamic async script "?dyn-async2" throttle=11
    //
    // After "?dyn-async2" execution, domComplete would arrive
    // We will add a extra dynamic async script "?dyn-async3" to
    // demostrate that domComplete is holded by this last extra script
  &lt;/script&gt;

  &lt;script defer src="./assets/junk.js?def1" throttle="6"&gt;&lt;/script&gt;

  &lt;script&gt;
    // mark: script execution -- inline 3
    // Adds a dynamic sync script "?dyn-sync1" throttle=7
  &lt;/script&gt;

  &lt;script defer src="./assets/junk.js?def2" throttle="4"&gt;&lt;/script&gt;

  &lt;!-- Long HTML contents --&gt;

  &lt;script&gt;
    // mark: script execution -- inline 4
    // Adds a dynamic sync script "?dyn-sync2" throttle=2
  &lt;/script&gt;
&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      14.90 <span style="opacity:.5">â”œ</span> requestStart
            <span style="opacity:.5">â”Š</span>
     423.10 <span style="opacity:.5">â”œ</span> responseStart
     433.80 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦ssets/junk.js?async1")</span>
     434.30 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦ssets/junk.js?async2")</span>
     434.70 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/assets/junk.js?def1")</span>
     434.80 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/assets/junk.js?def2")</span>
     442.00 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- inline 1</span>
     443.00 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/junk.js?dyn-async-1")</span>
     443.60 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- inline 2</span>
     443.80 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/junk.js?dyn-async-2")</span>
     444.60 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- inline 3</span>
     444.70 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦s/junk.js?dyn-sync-1")</span>
     482.40 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
     482.40 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-contentful-paint</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    1041.90 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦ssets/junk.js?async1")</span>
    1045.20 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- async 1</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    2886.10 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- inline 4</span>
    2886.60 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦s/junk.js?dyn-sync-2")</span>
    3004.30 <span style="opacity:.5">â”œ</span> responseEnd
    3004.90 <span style="opacity:.5">â”œ</span> domInteractive
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    4723.90 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/assets/junk.js?def2")</span>
            <span style="opacity:.5">â”Š</span>
    4921.80 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦s/junk.js?dyn-sync-2")</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    5646.10 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/junk.js?dyn-async-1")</span>
    5647.60 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- dynamic async 1</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    6618.30 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/assets/junk.js?def1")</span>
    6619.60 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- deferred 1</span>
    6619.80 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- deferred 2</span>
    6619.90 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
    6619.90 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    7796.70 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦s/junk.js?dyn-sync-1")</span>
    7798.10 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- dynamic sync 1</span>
    7798.20 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- dynamic sync 2</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
    9640.20 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦ssets/junk.js?async2")</span>
    9641.60 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- async 2</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   11739.20 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/junk.js?dyn-async-2")</span>
   11740.30 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- dynamic async 2</span>
   11740.50 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">callback execution -- onload dynamic async 2</span>
   11741.00 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">script("â€¦/junk.js?dyn-async-3")</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   14862.00 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">script("â€¦/junk.js?dyn-async-3")</span>
   14863.70 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution -- dynamic async 3</span>
   14863.70 <span style="opacity:.5">â”œ</span> domComplete
   14863.80 <span style="opacity:.5">â”œ</span> loadEventStart
   14863.80 <span style="opacity:.5">â””</span> loadEventEnd</pre>
        <figcaption>
          Timeline: Shows that all async scripts (initials or dynamically added) block nothing and get executed when they are ready. Deferred scripts hold the <code>DOMContentLoaded</code> event, and must wait other deferred scripts to be downloaded before executing. Dynamic sync scripts are executed in the order they where added to the document; in the example the dyn-sync-1 script takes a long time and holds the execution of dyn-sync-2. Finally domComplete won't happen until all pending scripts execute, disregarding how late they where added. In the example dyn-async-2 would have been the last resource, but we added a new script dyn-async-3 in its onload callback, thus posposing the <code>load</code> event.
        </figcaption>
    </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-style-script-inline-async">
    <h2>ğŸ“ It is possible to execute inline scripts without waiting for styles</h2>

    <p>We have seen <a href="#basic-html-style-script">that inlined scripts can't execute until the ongoing styles loading ends</a>.</p>

    <p>It is possible to overcome that limitation by mocking the inlined script as an external async script, using the <code>src</code> attribute to contain the code as a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs" target="_blank">data URL</a>. The downside is that the code must be URL encoded. It is not easy to manage.</p>

    <p>Note that this method would not be useful if we use <code>defer</code>, given that deferred scripts also await for the ongoing styles to finish loading.</p>

    <p><a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style-script-inline-async/" target="_blank"><button>Open example</button></a></p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>&lt;head&gt;
  &lt;link rel="stylesheet" href="./assets/new.css" throttle="10"&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;script async src="data:application/javascript,&lt;YOUR_CODE_HERE&gt;"&gt;&lt;/script&gt;

  &lt;!-- alternative as base64
    &lt;script async src="data:application/javascript;base64,cGVyZm9ybWFuY2UubWFyaygnc2NyaXB0IGV4ZWN1dGlvbicp"&gt;&lt;/script&gt;
  --&gt;

  &lt;!-- Long HTML contents --&gt;

&lt;/body&gt;</code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>
       0.00 <span style="opacity:.5">â”¬</span> startTime
      14.70 <span style="opacity:.5">â”œ</span> requestStart
      18.00 <span style="opacity:.5">â”œ</span> responseStart
      22.10 <span style="opacity:.5">â”œ</span> responseEnd
      27.10 <span style="opacity:.5">â”œ</span> resourceStart: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
      34.10 <span style="opacity:.5">â”œ</span> mark: <span style="opacity:.6">script execution</span>
      34.20 <span style="opacity:.5">â”œ</span> domInteractive
      34.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventStart
      34.20 <span style="opacity:.5">â”œ</span> domContentLoadedEventEnd
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
            <span style="opacity:.5">â”Š</span>
   10446.10 <span style="opacity:.5">â”œ</span> resourceEnd: <span style="opacity:.6">link("â€¦mples/assets/new.css")</span>
   10498.40 <span style="opacity:.5">â”œ</span> domComplete
   10498.50 <span style="opacity:.5">â”œ</span> loadEventStart
   10498.50 <span style="opacity:.5">â”œ</span> loadEventEnd
   10548.10 <span style="opacity:.5">â”œ</span> paint: <span style="opacity:.6">first-paint</span>
   10548.10 <span style="opacity:.5">â””</span> paint: <span style="opacity:.6">first-contentful-paint</span></pre>
        <figcaption>
          Timeline: An style starts to load very early. It blocks the <code>load</code> event, the rendering, and would block inline scripts too. The inline script of the example mocks an external async script behaviour, thus It can execute immediately without waiting for the style to load. Compare it with the <a href="#basic-html-style-script">regular inline script timeline</a>.</p>
        </figcaption>
    </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

  <hr>

  <article id="basic-html-">
    <h2>ğŸ“ Sit amet</h2>

    <p>Lorem ipsum</p>

    <p><a href="https://esroyo.github.io/pageload-examples/examples/basic-html-style-script-defer/" target="_blank"><button>Open example</button></a></p>

    <details>
      <summary>HTML outline</summary>
      <pre><code>

      </code></pre>
    </details>

    <details>
      <summary>Timeline</summary>
      <figure>
        <pre>

</pre>
        <figcaption>
          Timeline:
        </figcaption>
    </figure>
    </details>

    <p>[<a href="#toc">TOP</a>]</p>
  </article>

</body>
</html>

